<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thi·ªáp 20/10 üíñ G·ª≠i t·∫∑ng em üíï</title>
  <link href="https://fonts.googleapis.com/css2?family=Mali:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(135deg, #fffafa, #ffe6ef);
      font-family: "Mali", cursive;
      overflow: hidden;
      height: 100vh;
    }

    /* -------------------- HOA M·ªåC (M√ÄN M·ªû ƒê·∫¶U) -------------------- */
    .flower-scene {
      position: fixed;
      inset: 0;
      background: #fffafa;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 1000;
      transition: opacity 1s ease;
      overflow: hidden;
    }
    .flower-scene video {
      width: 420px;
      max-width: 92vw;
      object-fit: cover;
      border: none; outline: none; background: transparent;
    }
    .hint-text {
      margin-top: 10px;
      font-size: 1rem;
      color: #c2185b; font-weight: 600;
      animation: fadeHint 1.5s ease-in-out infinite;
    }
    @keyframes fadeHint { 0%,100%{opacity:.6} 50%{opacity:1} }

    /* üíå Thi·ªáp nh·ªè m·ªü ƒë·∫ßu (flip 3D) */
    .small-card {
      margin-top: 20px;
      width: 120px; height: 80px;
      background: #ffe4ec; border: 2px solid #f8bbd0; border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.3rem; color: #c2185b; cursor: pointer;
      perspective: 800px; font-weight: 600; animation: cardPulse 2s ease-in-out infinite;
    }
    .card-inner { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; transition: transform 1s ease; }
    .small-card.opened .card-inner { transform: rotateY(180deg); }
    .card-front, .card-back {
      position: absolute; inset: 0; backface-visibility: hidden; border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
    }
    .card-front { background:#ffe4ec; }
    .card-back  { background:#f8bbd0; transform: rotateY(180deg); font-size: 1rem; }
    @keyframes cardPulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05)} }

    /* üíñ Tr√°i tim/hoa r∆°i (d√πng cho c·∫£ 2 m√†n) */
    .heart {
      position: absolute; top: -10px; color: #e91e63;
      font-size: 18px; animation: fall 5s linear forwards; opacity: .85; pointer-events: none;
    }
    @keyframes fall { 0%{transform:translateY(0) rotate(0);opacity:1} 100%{transform:translateY(100vh) rotate(360deg);opacity:0} }

    /* -------------------- THI·ªÜP CH√çNH -------------------- */
    .center-message {
      display: none;
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(135deg, #ffeef8, #fff6fa, #ffffff);
      padding: 40px 50px; border-radius: 30px;
      text-align: center; color: #c2185b; font-size: 1.5rem;
      box-shadow: 0 20px 60px rgba(216,27,96,0.3); backdrop-filter: blur(10px);
      opacity: 0; transition: all 1s ease;
      max-width: min(90vw, 720px);
    }
    .center-message.show { opacity: 1; transform: translate(-50%, -50%); }
    .center-message strong {
      font-size: 2rem; display:block;
      background: linear-gradient(45deg, #d81b60, #f06292, #d81b60);
      background-size: 200% auto; background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      animation: gradient 3s ease infinite;
    }
    @keyframes gradient { 0%,100%{background-position:0% 50%} 50%{background-position:100% 50%} }

    .replay-btn {
      margin-top: 20px; padding: 10px 20px; border-radius: 20px; border: none;
      background: #f48fb1; color: white; cursor: pointer; font-size: 1rem; transition: background .3s;
    }
    .replay-btn:hover { background:#ec407a; }

    /* -------------------- GALLERY POPUP -------------------- */
    .overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,.55); backdrop-filter: blur(3px); z-index: 900; }
    .gallery { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); z-index: 1000;
               width: min(92vw, 820px); max-height: 90vh;
               background: linear-gradient(135deg,#fff,#fff5f8); border-radius: 22px; padding: 16px 16px 20px;
               box-shadow: 0 25px 80px rgba(216,27,96,0.4); border: 3px solid rgba(255,255,255,.9); }
    .gal-head { display:flex; justify-content: space-between; align-items:center; margin-bottom:8px; }
    .gal-title { color:#c2185b; font-weight:700; font-size:1.05rem; }
    .gal-close { background:transparent; border:none; font-size:1.4rem; cursor:pointer; color:#ad1457; }
    .gal-body { position:relative; display:flex; align-items:center; justify-content:center; overflow:hidden; border-radius: 12px; }
    #galImg { max-width:100%; max-height:62vh; border-radius:12px; transition: opacity .35s ease; }
    .gal-caption { margin-top:12px; color:#c2185b; font-size:1.05rem; text-align:center; min-height: 2.6em; }
    .nav-btn {
      position:absolute; top:50%; transform: translateY(-50%);
      background: rgba(255,240,245,.9); border: 2px solid #f8bbd0; color:#ad1457;
      width:44px; height:44px; border-radius: 50%; cursor:pointer; font-size:1.2rem; font-weight:700;
      display:flex; align-items:center; justify-content:center; box-shadow:0 8px 24px rgba(216,27,96,.25);
    }
    .nav-btn:hover { transform: translateY(-50%) scale(1.06); }
    #prevBtn { left: 8px; }
    #nextBtn { right: 8px; }

    /* -------------------- QU√Ä R∆†I -------------------- */
    .falling-letter {
      position: absolute; top: -100px; width: 50px;
      animation: fall 8s linear; user-select: none; z-index: 2; cursor: pointer; transition: transform .25s ease;
    }
    .falling-letter:hover { transform: scale(1.18); filter: drop-shadow(0 0 10px rgba(216,27,96,.5)); }
  </style>
</head>

<body>
  <!-- üå∏ HOA M·ªåC + THI·ªÜP NH·ªé -->
  <div class="flower-scene" id="flowerScene">
    <video id="flowerVideo" src="./assets/tt1.mp4" autoplay muted playsinline></video>

    <div class="small-card" id="smallCard">
      <div class="card-inner">
        <div class="card-front">üíå</div>
        <div class="card-back">M·ªü thi·ªáp</div>
      </div>
    </div>

    <div class="hint-text">üëâ Click v√†o thi·ªáp ƒë·ªÉ m·ªü üíï</div>
  </div>

  <!-- üå∫ THI·ªÜP CH√çNH -->
  <div class="center-message" id="mainCard">
    <strong>Thi·ªáp 20/10 üíñ G·ª≠i t·∫∑ng Em üíï</strong>
    <span id="centerText">
      Ng√†y Ph·ª• n·ªØ Vi·ªát Nam üå∏<br>
      Ch∆∞a ph·∫£i l√† ph·ª• n·ªØ nh∆∞ng v·∫´n ch√∫c em lu√¥n xinh ƒë·∫πp, m·∫°nh m·∫Ω v√† h·∫°nh ph√∫c m·ªói ng√†y!!!
    </span><br>
    <button class="replay-btn" id="replayBtn">üîÅ m√∫n xem l·∫°i t·ª´ ƒë·∫ßu th√¨ ·∫•n v√†o ƒë√¢y nh√≥ </button>
  </div>

  <!-- üéÅ POPUP GALLERY -->
  <div class="overlay" id="overlay"></div>
  <div class="gallery" id="gallery">
    <div class="gal-head">
      <div class="gal-title">Album 20/10</div>
      <button class="gal-close" id="closeGal">‚úï</button>
    </div>
    <div class="gal-body">
      <button class="nav-btn" id="prevBtn">‚Äπ</button>
      <img id="galImg" src="" alt="Qu√† 20/10">
      <button class="nav-btn" id="nextBtn">‚Ä∫</button>
    </div>
    <div class="gal-caption" id="galCaption">‚Äî</div>
  </div>

  <!-- Nh·∫°c & SFX -->
  <audio id="player" src="./assets/a.mp3"></audio>
  <audio id="sfx" src="./assets/pop.mp3"></audio>

  <script>
    /* üíñ Tr√°i tim/hoa r∆°i (d√πng cho c·∫£ 2 m√†n) */
    function createHeart() {
      const heart = document.createElement("div");
      heart.classList.add("heart");
      heart.textContent = Math.random() < 0.5 ? "üíñ" : "üå∏";
      heart.style.left = Math.random() * 100 + "vw";
      heart.style.fontSize = Math.random() * 10 + 15 + "px";
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 5000);
    }
    setInterval(createHeart, 550);

    /* üå∑ M·ªû THI·ªÜP: ·∫©n m√†n ƒë·∫ßu ‚Üí hi·ªán thi·ªáp ch√≠nh + nh·∫°c */
    const flowerScene = document.getElementById("flowerScene");
    const smallCard   = document.getElementById("smallCard");
    const mainCard    = document.getElementById("mainCard");
    const replayBtn   = document.getElementById("replayBtn");

    smallCard.addEventListener("click", () => {
      smallCard.classList.add("opened");
      setTimeout(() => {
        flowerScene.style.opacity = "0";
        setTimeout(() => {
          flowerScene.style.display = "none";
          mainCard.style.display = "block";
          setTimeout(() => mainCard.classList.add("show"), 50);
          document.getElementById("player").play().catch(()=>{});
        }, 1000);
      }, 1000);
    });

    /* üîÅ Xem l·∫°i t·ª´ ƒë·∫ßu */
    replayBtn.addEventListener("click", () => {
      mainCard.classList.remove("show");
      setTimeout(() => {
        mainCard.style.display = "none";
        flowerScene.style.display = "flex";
        setTimeout(() => flowerScene.style.opacity = "1", 50);
      }, 450);
    });

    /* üéÅ D·ªÆ LI·ªÜU GALLERY: 12 ·∫£nh xen k·∫Ω (v·∫Ω & ch·ª•p) + l·ªùi ch√∫c t∆∞∆°ng ·ª©ng */
    const galleryData = [
      { src: "./assets/a1.jpg",  text: "Nh·ªØng b√¥ng hoa h·ªìng ph·∫•n thay l·ªùi mu·ªën n√≥i: Em th·∫≠t d·ªãu d√†ng v√† ƒë√°ng y√™u! üå∑" },
      { src: "./assets/a6.jpg",  text: "Kho·∫£nh kh·∫Øc ƒë·ªùi th∆∞·ªùng c≈©ng h√≥a ƒë·∫πp khi c√≥ n·ª• c∆∞·ªùi c·ªßa em üíñ" },
      { src: "./assets/a2.jpg",  text: "Mong m·ªói ng√†y em ƒë·ªÅu l√† m·ªôt ƒëo√° hoa n·ªü r·ªô ‚Äì h√£y c·ª© r·ª±c r·ª° nh∆∞ th·∫ø nh√©! ‚ú®" },
      { src: "./assets/a7.jpg",  text: "D√¨u d·ªãu l√† gi√≥, an y√™n l√† b·∫°n ‚Äì mong b√¨nh y√™n theo em th·∫≠t l√¢u üåø" },
      { src: "./assets/a3.jpg",  text: "H√£y lu√¥n m·∫°nh m·∫Ω, t·ª≠ t·∫ø v√† truy·ªÅn c·∫£m h·ª©ng cho m·ªçi ng∆∞·ªùi em nh√© üå∏" },
      { src: "./assets/a8.jpg",  text: "Ng√†y n√†o c≈©ng t∆∞∆°i ƒë·∫πp ‚Äì khi em m·ªâm c∆∞·ªùi, c·∫£ b·∫ßu tr·ªùi c≈©ng ngot ng√†o h∆°n ‚òÄÔ∏è" },
      { src: "./assets/a4.jpg",  text: "Ch√∫c 20/10 c·ªßa em ng·∫≠p tr√†n y√™u th∆∞∆°ng, c√≥ hoa v√† nh·ªØng ƒëi·ªÅu ng·ªçt ng√†o üíó" },
      { src: "./assets/a9.jpg",  text: "ƒêi qua bao kh√≥ khƒÉn, √°p l·ª±c, v·∫´n mong em lu√¥n v·ªØng v√†ng v√† h·∫°nh ph√∫c üéÄ" },
      { src: "./assets/a5.jpg",  text: "EM l√† m√≥n qu√† tuy·ªát v·ªùi nh·∫•t m√† cu·ªôc s·ªëng mang l·∫°i ‚Äì lu√¥n lu√¥n l√† th·∫ø üéÅ" },
      { src: "./assets/a10.jpg", text: "Mong b√¨nh an v√† may m·∫Øn lu√¥n ·ªü b√™n, tr√™n m·ªçi n·∫ªo ƒë∆∞·ªùng em ƒëi üçÄ" },
      { src: "./assets/a11.jpg", text: "Xin d√†nh t·∫∑ng em th·∫≠t nhi·ªÅu y√™u th∆∞∆°ng ‚Äì h√¥m nay v√† m√£i v·ªÅ sau üíû" },
      { src: "./assets/a12.jpg", text: "Ch√∫c em lu√¥n r·∫°ng r·ª°, nh∆∞ b√¥ng hoa n·ªü ƒë√∫ng m√πa ‚Äì ƒë·∫πp nh·∫π nh√†ng m√† b·ªÅn l√¢u üå∑" }
    ];

    /* üéÅ POPUP GALLERY: ƒëi·ªÅu khi·ªÉn & hi·ªÉn th·ªã */
    const overlay   = document.getElementById("overlay");
    const galleryEl = document.getElementById("gallery");
    const galImg    = document.getElementById("galImg");
    const galCap    = document.getElementById("galCaption");
    const prevBtn   = document.getElementById("prevBtn");
    const nextBtn   = document.getElementById("nextBtn");
    const closeGal  = document.getElementById("closeGal");
    const sfx       = document.getElementById("sfx");

    let galIndex = 0;

    function openGallery(startIndex = 0) {
      galIndex = startIndex % galleryData.length;
      renderGallery();
      overlay.style.display = "block";
      galleryEl.style.display = "block";
      try { sfx && sfx.play(); } catch(e){}
    }
    function closeGallery() {
      galleryEl.style.display = "none";
      overlay.style.display = "none";
    }
    function renderGallery() {
      const {src, text} = galleryData[galIndex];
      galImg.style.opacity = "0";
      setTimeout(() => {
        galImg.src = src;
        galImg.onload = () => { galImg.style.opacity = "1"; };
        galCap.textContent = text;
      }, 150);
    }
    function nextImg() { galIndex = (galIndex + 1) % galleryData.length; renderGallery(); }
    function prevImg() { galIndex = (galIndex - 1 + galleryData.length) % galleryData.length; renderGallery(); }

    nextBtn.addEventListener("click", nextImg);
    prevBtn.addEventListener("click", prevImg);
    closeGal.addEventListener("click", closeGallery);
    overlay.addEventListener("click", closeGallery);
    document.addEventListener("keydown", (e) => {
      if (galleryEl.style.display === "block") {
        if (e.key === "ArrowRight") nextImg();
        if (e.key === "ArrowLeft")  prevImg();
        if (e.key === "Escape")     closeGallery();
      }
    });

    /* üí• N·ªï tr√°i tim khi click qu√† */
    function createExplosion(x, y) {
      for (let i = 0; i < 6; i++) {
        const h = document.createElement("div");
        h.textContent = Math.random() < 0.5 ? "üíñ" : "üå∏";
        h.style.position = "absolute"; h.style.left = x + "px"; h.style.top = y + "px";
        h.style.fontSize = (Math.random() * 10 + 16) + "px";
        h.style.transition = "all 1s ease-out";
        h.style.pointerEvents = "none";
        document.body.appendChild(h);
        setTimeout(() => { h.style.transform = `translate(${(Math.random()-0.5)*220}px, ${(Math.random()-0.5)*220}px)`; h.style.opacity = "0"; }, 10);
        setTimeout(() => h.remove(), 1000);
      }
    }

    /* üåßÔ∏è T·∫°o ‚Äúqu√† r∆°i‚Äù (click ƒë·ªÉ m·ªü gallery) */
    function createFallingGift() {
      const letter = document.createElement("img");
      const imgs = ["./assets/letters.png","./assets/q3.png","./assets/h1.png","./assets/h3.png","./assets/t2.png","./assets/t5.png"];
      letter.src = imgs[Math.floor(Math.random() * imgs.length)];
      letter.classList.add("falling-letter");
      letter.style.left = Math.random() * (window.innerWidth - 50) + "px";
      letter.addEventListener("click", (e) => {
        createExplosion(e.pageX, e.pageY);
        openGallery(galIndex); // m·ªü gallery t·ª´ ·∫£nh hi·ªán t·∫°i
      });
      document.body.appendChild(letter);
      setTimeout(() => letter.remove(), 8000);
    }
    setInterval(createFallingGift, 1000);
  </script>
</body>
</html>
